define("confluence-dashboard/modules/onboarding/onboarding-view",["module","exports","../../core/shared/base-dialog","confluence-dashboard/soy-templates","configuration","../../utils/feature-discovery","underscore"],function(e,i,t,o,n,s,a){"use strict";var r=f(t).default,d=f(o).default,l=n.pluginKey,u=(n.staticResourceUrl,f(s).default),c=f(a).default;function f(e){return e&&e.__esModule?e:{default:e}}i.default=r.extend({attributes:{id:"dashboard-onboarding-dialog","aria-hidden":!0},ui:{btnShow:".show-onboarding",btnSkip:".skip-onboarding"},events:{"click @ui.btnShow":"showOnboarding","click @ui.btnSkip":"skipOnboarding"},initialize:function(){this.featureDiscovery=u.forPlugin(l),this.featureDiscovery.canShow("dialog")?this.openDialog():this.remove()},onDestroy:function(){this.featureDiscovery=null},getTemplate:function(){return this.options.isNewUser?d.Onboarding.newUser:d.Onboarding.existingUser},showOnboarding:function(){this.featureDiscovery.markDiscoveredSafe("dialog"),this.closeDialog(),this.options.onConfirm&&c.isFunction(this.options.onConfirm)&&this.options.onConfirm()},skipOnboarding:function(){this.featureDiscovery.markDiscoveredSafe("dialog"),this.featureDiscovery.markDiscoveredSafe("tips"),this.closeDialog()}}),e.exports=i.default}),define("confluence-dashboard/modules/onboarding/onboarding-tooltip-view",["module","exports","marionette","configuration","jquery","../../utils/feature-discovery","../../utils/ensure-component","../../utils/event-manager"],function(e,i,t,o,n,s,a,r){"use strict";var d=t.ItemView,l=o.pluginKey,u=h(n).default,c=h(s).default,f=h(a).default,p=r.EventManager;function h(e){return e&&e.__esModule?e:{default:e}}i.default=d.extend({className:"onboarding-tooltip-wrapper",initialize:function(){this.featureDiscovery=c.forPlugin(l),this.target=this.options.placedNextTo,this.tipId=this.options.tipId,this.addToScreen()},addToScreen:function(){var e=this;if(this.featureDiscovery.canShow(this.tipId)){u(this.target).append(this.render().el);var i=this.$(".onboarding-tooltips");f(i[0]).then(function(){i.find(".btn-next").on("click",e.showNext.bind(e)),i.find(".btn-skip").on("click",e.skipTooltips.bind(e))}),this.listenTo(p,"sidebar:collapse",this.close.bind(this)),this.listenTo(p,"window:scroll",this.close.bind(this)),this.inlineDialog=i[0]}else this.destroy()},open:function(){var e=this;f(this.inlineDialog).then(function(){e.inlineDialog.open=!0})},close:function(){var e=this;f(this.inlineDialog).then(function(){e.inlineDialog.open=!1})},showNext:function(){this.featureDiscovery.markDiscovered(this.tipId),this.close(),this.trigger("next",this),this.destroy()},skipTooltips:function(){this.trigger("skip",this)},onDestroy:function(){var e=this;this.inlineDialog&&f(this.inlineDialog).then(function(){return e.inlineDialog.remove()})}}),e.exports=i.default}),define("confluence-dashboard/modules/onboarding/onboarding-tooltips-manager",["module","exports","marionette","confluence-dashboard/soy-templates","./onboarding-tooltip-view","underscore","configuration","../../utils/feature-discovery","../../utils/event-manager","window"],function(e,i,t,o,n,s,a,r,d,l){"use strict";var u=t.Object,c=m(o).default,f=m(n).default,p=m(s).default,h=a.pluginKey,g=m(r).default,b=d.ReqRes,v=m(l).default;function m(e){return e&&e.__esModule?e:{default:e}}i.default=u.extend({initialize:function(){v.require(["aui/inline-dialog2"]),b.request("app").expandSidebar(),this.featureDiscovery=g.forPlugin(h)},getTooltipDefinitions:function(e){return[{element:".sidebar-discover",tipId:"tour-step-sidebar",template:c.Onboarding[e.isNew?"newUserStep1":"existingUserStep1"]},{element:".sidebar-spaces",tipId:"tour-step-favourite-spaces",template:c.Onboarding[e.isNew?"newUserStep2":"existingUserStep2"]}]},showTips:function(e){var i=this.getTooltipDefinitions(e);this.createSteps(i)},createSteps:function(e){var i=this;return!!e&&(!!this.featureDiscovery.canShow("tips")&&(this.steps=[],p.each(e,function(e){i.featureDiscovery.canShow(e.tipId)&&i.steps.push(i.createTooltip(e))}),void this.openFirst()))},createTooltip:function(e){var i=new f({tipId:e.tipId,placedNextTo:e.element,template:e.template,templateHelpers:{id:e.tipId}});return this.listenTo(i,"skip",this.onSkip),this.listenTo(i,"next",this.onNext),i},openFirst:function(){0<this.steps.length&&this.steps[0].open()},onSkip:function(){this.featureDiscovery.markDiscovered("tips"),p.invoke(this.steps,"destroy"),this.destroy()},onNext:function(e){var i=this.steps.indexOf(e);this.steps.splice(i,1),this.openFirst()}}),e.exports=i.default}),define("confluence-dashboard/modules/onboarding/onboarding-saved-for-later-view",["module","exports","./onboarding-tooltip-view"],function(e,i,t){"use strict";var o,n=((o=t)&&o.__esModule?o:{default:o}).default;i.default=n.extend({showNext:function(){},skipTooltips:function(){this.featureDiscovery.markDiscovered(this.tipId),this.close(),this.destroy()}}),e.exports=i.default}),define("confluence-dashboard/modules/onboarding/onboarding-controller",["../../utils/event-manager","./onboarding-view","./onboarding-tooltips-manager","../../utils/module-starter","confluence/meta","../../utils/conditions","ajs","confluence-dashboard/soy-templates","./onboarding-saved-for-later-view","configuration","../../utils/feature-discovery"],function(e,i,t,o,n,s,a,r,d,l,u){"use strict";var c=e.Commands,f=x(i).default,p=x(t).default,h=x(o).default,g=x(n).default,b=x(s).default,v=x(a).default,m=x(r).default,w=x(d).default,D=l.pluginKey,y=x(u).default;function x(e){return e&&e.__esModule?e:{default:e}}function k(e){(new p).showTips(e)}function S(){var e=g.getBoolean("is-new-user"),i=g.getBoolean("show-dashboard-onboarding-dialog"),t=g.getBoolean("show-dashboard-onboarding-tips"),o="transition-saved-for-later",n={isNew:e};if(i){var s=new f({isNewUser:e,onConfirm:function(){k(n)}});c.execute("main-app:showDialog",s)}else if(t)k(n);else if(!e)new w({tipId:o,placedNextTo:".nav-item-container-starred",template:m.Onboarding.transitionSavedForLater,templateHelpers:{id:o}});e&&y.forPlugin(D).markDiscovered(o)}v.toInit(function(){b.canShowDashboard()&&h.register(S)})}),require(["confluence-dashboard/modules/onboarding/onboarding-controller"]);