define("confluence-keyboard-shortcuts/confluence-keyboard-shortcuts",["ajs","jquery","confluence/legacy","window"],function(a,c,b,g){var e={createShortcutFunc:function(d){switch(d.op){case "click":return function(){c(d.param).click()};case "execute":return d.param}},normalizeShortcutKeys:function(d,a){var b=d.toLowerCase();return a.isMac&&"4"===a.majorVersion?b.replace(/ctrl/g,"meta"):b},isAnyShortcutInEvent:function(d,a){return a.some(function(a){var b=1;d.metaKey&&b++;d.shiftKey&&b++;return a.split("+").every(function(a){b--;
return e._isKeyInShortcutString(d,a)})&&0===b})},_isKeyInShortcutString:function(a,b){var c=a.keyCode?a.keyCode:a.which,c=c?String.fromCharCode(c).toLowerCase():"",e=!!("shift"===b&&a.shiftKey);return!(!("meta"===b||"ctrl"===b)||!a.metaKey)||e||b===c}},f={init:function(){a.debug("confluence-keyboard-shortcuts initialising");a.PageGadget||g.parent.AJS&&g.parent.AJS.PageGadget?a.debug("Inside the Page Gadget. Skipping keyboard shortcuts"):(b.KeyboardShortcuts.enabled=a.Meta.getBoolean("use-keyboard-shortcuts"),
a.bind("shortcuts-loaded.keyboardshortcuts",function(a,e){b.KeyboardShortcuts.shortcuts=e.shortcuts;c("#keyboard-shortcuts-link").click(b.KeyboardShortcuts.openDialog)}),a.bind("register-contexts.keyboardshortcuts",function(d,g){if(b.KeyboardShortcuts.enabled){var h=g.shortcutRegistry;h.enableContext("global");var f=b&&b.Editor&&b.Editor.isVisible&&b.Editor.isVisible();c("#action-menu-link").length&&!f&&h.enableContext("viewcontent");c("#viewPageLink").length&&h.enableContext("viewinfo");if(!f)return b.KeyboardShortcuts.ready=
!0;h.enableContext("editor");var i=require("tinymce"),j=i.activeEditor,k=c("#rte").closest("form");b.KeyboardShortcuts.shortcuts.filter(function(a){return 0===a.context.indexOf("tinymce")}).forEach(function(b){b.keys.forEach(function(c){var d=e.createShortcutFunc(b);d||a.logError("ERROR: unkown editor shortcut key operation "+b.op+" for shortcut "+c);var f=(Array.isArray(c)?c:[c]).map(function(a){return e.normalizeShortcutKeys(a,i)}),c=e.normalizeShortcutKeys(f.join(","),i);a.debug("Adding shortcut for "+
c);j.addShortcut(c,"",d);"tinymce.actions"==b.context&&-1!==c.indexOf("+")&&(a.debug("Binding shortcut on inputs too for "+c),k.delegate(":input","keydown",function(a){e.isAnyShortcutInEvent(a,f)&&(d(),a.preventDefault())}))})});b.KeyboardShortcuts.ready=!0}}),"undefined"!==typeof a.contextPath()&&(c("#rte").length?a.bind("init.rte",function(){a.trigger("initialize.keyboardshortcuts")}):a.trigger("initialize.keyboardshortcuts")))},keyboardShortcuts:{Editor:[],enabled:!1,ready:!1,dialog:null,closeDialog:function(){b.KeyboardShortcuts.getDialog().then(function(a){a.hide()});
return!1},openDialog:function(){c(this).removeClass("interactive");b.KeyboardShortcuts.getDialog().then(function(a){a.show()});return!1}}};f._logic=e;return f});require("confluence/module-exporter").safeRequire("confluence-keyboard-shortcuts/confluence-keyboard-shortcuts",function(a){var c=require("confluence/legacy"),b=require("ajs");c.KeyboardShortcuts=a.keyboardShortcuts;b.toInit(a.init)});