define("confluence-editor/tinymce3/plugins/table/atlassian-table-picker",["ajs","tinymce","jquery","document"],function(c,E,g,O){function F(){e.css({top:g("#insert-table-dropdown").outerHeight(!0)});F=function(){}}function j(){if(!e.hasClass("hidden")){var a=g(c.Rte.getEditor().getDoc());k.unbind(".atlassian-table-picker");a.unbind(".atlassian-table-picker");e.addClass("hidden");q.addClass("hidden");y.removeClass("active")}}function G(a,b){c.debugEnabled()&&c.debug("setSize("+[a,b]+")");a==f&&b==
r||(a=Math.max(1,Math.min(H,a)),b=Math.max(1,Math.min(I,b)),n=Math.max(P,a),s=Math.max(Q,b),f=a,r=b,t.width(n*l+1),t.height(s*m+R),u(o,n,s),u(z,f,r),u(A,n,1),u(v,f,1),J(),K.text(f+" x "+r))}function J(){A.toggleClass("hidden",!h);v.toggleClass("hidden",!h)}function u(a,b,c){a.width(l*b+1);a.height(m*c+1)}function S(a){var b=o.offset(),d=b.top-k.scrollTop(),g=b.left-k.scrollLeft(),b=d+o.outerHeight(!0)+w,e=b-m-w,h=g+o.outerWidth(!0)+w,j=h-l-w,f=a.clientY,i=a.clientX,a=n,p=s;c.debugEnabled()&&c.debug("[mouseX,spLeft,spRightShrink,spRightGrow][mouseY,spTop,spBottomShrink,spBottomGrow] = "+
[i,g,j,h]+"/"+[f,d,e,b]);i>h?(d=~~((i-h)/l+1),a+=d,c.debugEnabled()&&c.debug("grow: xdelta = "+d)):i<j&&(d=~~((i-j)/l-1),a+=d,c.debugEnabled()&&c.debug("shrink: xdelta = "+d));f>b?(d=~~((f-b)/m+1),p+=d,c.debugEnabled()&&c.debug("grow: ydelta = "+d)):f<e&&(d=~~((f-e)/m-1),p+=d,c.debugEnabled()&&c.debug("shrink: ydelta = "+d));G(a,p)}function L(a){c.debugEnabled()&&c.debug("enableHeading("+a+")");a!=h&&(h=a,J())}function B(a){var b;b=~~(~~(a.offsetX||a.originalEvent.layerX)/l)+1;var d=~~(~~(a.offsetY||
a.originalEvent.layerY)/m)+1;b=1>b||b>H||1>d||d>I?null:{width:b,height:d};a.preventDefault();c.debug("insertTable: size = "+(b&&[b.width,b.height]));if(b){j();a=b.width;d=b.height;b=h;var e,f;c.debugEnabled()&&c.debug("shamefulInsertTable("+a+","+d+","+b+")");e=g("#tinymce-table-form");e.length?(e.find('input[name="rows"]').val(d),e.find('input[name="cols"]').val(a)):(a=c.renderTemplate("tableForm",d,a),f=g("<div></div>").addClass("hidden"),f.append(a),M.append(f));g("#table-heading-checkbox").prop("checked",
b);c.Rte.BookmarkManager.restoreBookmark();E.activeEditor.undoManager.beforeChange();E.activeEditor.plugins.table.insertTable();f&&f.remove()}}function x(a){c.debugEnabled()&&c.debug("key: "+a.charCode+"/"+a.keyCode+"/"+a.shiftKey);c.debug("key: "+a.charCode+"/"+a.keyCode+"/"+a.shiftKey);g.browser.msie?(16===a.keyCode&&L(!a.shiftKey),27===a.keyCode&&j()):(0===a.charCode&&L(!a.shiftKey),27===a.keyCode&&0===a.charCode&&j())}function T(){j()}var N={},k,M,q,i,C,y,e,t,o,A,z,v,K,P=4,Q=4,H=15,I=20,l=25,
m=17,R=20,w=0,n,s,f,r,h,D=!1;N.insertTable=B;return{bindToControl:function(){c.debugEnabled()&&c.debug("Table Picker - bind to control");k=g(O);M=k.find("body");i=g("#insert-table-dropdown");C=g("#rte-button-insert-table");y=i.find(".aui-dd-parent");e=g("#table-picker-container");t=e.find(".table-picker-box");o=e.find(".picker-cell");A=e.find(".picker-heading");z=e.find(".picker-selected-cell");v=e.find(".picker-selected-heading");K=t.find(".desc");q=g("<div></div>").attr("id","table-picker-backdrop").addClass("hidden").appendTo(i);
C.click(function(a){a.preventDefault();D||(c.Rte.BookmarkManager.storeBookmark(),F(),h=!0,G(1,1),a=g(c.Rte.getEditor().getDoc()),k.bind("mousemove.atlassian-table-picker",S),k.bind("keydown.atlassian-table-picker",x),k.bind("keyup.atlassian-table-picker",x),a.bind("keydown.atlassian-table-picker",x),a.bind("keyup.atlassian-table-picker",x),q.removeClass("hidden"),e.removeClass("hidden"),y.addClass("active"),C.focus())});q.click(T);z.click(B);v.click(B)},disable:function(){D=!0;i.addClass("disabled")},
enable:function(){D=!1;i.removeClass("disabled")},close:j,_internal:N}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/table/atlassian-table-picker","AJS.Rte.TablePicker");