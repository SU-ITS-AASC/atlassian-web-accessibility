define("office-connector/edit-in-office-plugin",["jquery","ajs","office-connector/edit-in-office"],function(c,h,f){var i=function(j){j.on("fv.showFile fv.showFileError",function(k){var l=k.get("name");if(!l){throw new Error('Office connector expects the "name" property to be passed by the file viewer')}if(k&&b(l)&&d()){j.addFileAction({key:"edit-in-office",text:h.I18n.getText("office.connector.attachment.edit"),callback:g})}})};var d=function(){return h.Meta.get("content-type")==="page"||h.Meta.get("content-type")==="blogpost"};var b=function(k){var j=(f.getProgID(k)!=="");return j&&(a()||e())};var a=function(){var j,k=(window.ActiveXObject!==undefined);if(k){try{j=new ActiveXObject("SharePoint.OpenDocuments.1")}catch(l){}}return j};var e=function(){return window.URLLauncher||window.InstallTrigger};var g=function(j){var l=j.get("attachmentId")||j.get("id");var k=h.contextPath();c.getJSON(k+"/rest/office/1.0/metadata/"+l).done(function(o){var p=k+o.webDavUrl;var n=o.usePathAuth;var m=getProgID(p);return f.doEditInOffice(k,p,m,n)})};return i});var FileViewer=require("FileViewer");var EditInOfficePlugin=require("office-connector/edit-in-office-plugin");FileViewer.registerPlugin("editInOffice",EditInOfficePlugin);