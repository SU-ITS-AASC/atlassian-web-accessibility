define("confluence-dashboard/modules/onboarding/onboarding-tooltips-manager",["module","exports","marionette","confluence-dashboard/soy-templates","./onboarding-tooltip-view","underscore","configuration","../../utils/feature-discovery","../../utils/event-manager","window"],function(e,t,i,s,n,o,r,a,p,u){"use strict";function d(e){return e&&e.__esModule?e:{default:e}}var l=i.Object,c=d(s).default,f=d(n).default,h=d(o).default,v=r.pluginKey,g=d(a).default,m=p.ReqRes,b=d(u).default;t.default=l.extend({initialize:function(){b.require(["aui/inline-dialog2"]),m.request("app").expandSidebar(),this.featureDiscovery=g.forPlugin(v)},getTooltipDefinitions:function(e){return[{element:".sidebar-discover",tipId:"tour-step-sidebar",template:c.Onboarding[e.isNew?"newUserStep1":"existingUserStep1"]},{element:".sidebar-spaces",tipId:"tour-step-favourite-spaces",template:c.Onboarding[e.isNew?"newUserStep2":"existingUserStep2"]}]},showTips:function(e){var t=this.getTooltipDefinitions(e);this.createSteps(t)},createSteps:function(e){var t=this;return!!e&&(!!this.featureDiscovery.canShow("tips")&&(this.steps=[],h.each(e,function(e){t.featureDiscovery.canShow(e.tipId)&&t.steps.push(t.createTooltip(e))}),void this.openFirst()))},createTooltip:function(e){var t=new f({tipId:e.tipId,placedNextTo:e.element,template:e.template,templateHelpers:{id:e.tipId}});return this.listenTo(t,"skip",this.onSkip),this.listenTo(t,"next",this.onNext),t},openFirst:function(){this.steps.length>0&&this.steps[0].open()},onSkip:function(){this.featureDiscovery.markDiscovered("tips"),h.invoke(this.steps,"destroy"),this.destroy()},onNext:function(e){var t=this.steps.indexOf(e);this.steps.splice(t,1),this.openFirst()}}),e.exports=t.default});