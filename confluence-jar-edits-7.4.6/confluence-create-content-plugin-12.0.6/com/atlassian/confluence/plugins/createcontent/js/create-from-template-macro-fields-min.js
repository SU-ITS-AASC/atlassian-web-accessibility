AJS.toInit(function(f){function h(a,b){a=a||AJS.Meta.get("space-key");Confluence.Blueprint.Dialog.requestWebItems(a,!1,function(d){var e=Confluence.Blueprint.Dialog.loadedWebitems[a];_.isEmpty(e)?AJS.log("create-from-template-macro-fields: No Create dialog web items found for spaceKey \x3e"+a+"\x3c"):b(d,e)},function(){AJS.error("create-from-template-macro-fields: requestWebItems call for spaceKey \x3e"+a+"\x3c failed")})}function g(a,b){h(b,function(b,e){b=a.val();a.empty();_.each(e,function(b){var c=
b.itemModuleCompleteKey;"com.atlassian.confluence.plugins.confluence-create-content-plugin:create-blank-page"!==c&&"com.atlassian.confluence.plugins.confluence-create-content-plugin:create-blog-post"!==c&&(b.templateId||b.contentBlueprintId)&&(c=f("\x3coption\x3e\x3c/option\x3e").text(b.name),c.attr("data-template-id",b.templateId),c.attr("data-blueprint-module-complete-key",b.blueprintModuleCompleteKey),c.attr("data-content-blueprint-id",b.contentBlueprintId),c.attr("data-create-result",b.createResult),
c.val(b.templateId||b.contentBlueprintId),a.append(c))});a.val(b)})}AJS.MacroBrowser.setMacroJsOverride("create-from-template",{fields:{spacekey:{spaceKey:function(a){var b=AJS.MacroBrowser.ParameterFields.spacekey(a),d=b.input.val();a=function(){var a=b.input.val();a!=d&&g(AJS.MacroBrowser.fields.templateName.input,a);d=a};b.input.bind("selected.autocomplete-content",a);b.input.blur(a);return b}}},beforeParamsSet:function(a,b){a.buttonLabel=a.buttonLabel||a.createButtonLabel||AJS.I18n.getText("com.atlassian.confluence.plugins.confluence-create-content-plugin.create-from-template.param.buttonLabel.default-value");
g(f("#macro-param-templateName"),a.spaceKey);return a},beforeParamsRetrieved:function(a,b,d){b=AJS.MacroBrowser.fields.templateName.input.find("option:selected");a.blueprintModuleCompleteKey=b.data("blueprint-module-complete-key");a.contentBlueprintId=b.data("content-blueprint-id");a.templateId=b.data("template-id");a.createResult=b.data("create-result");return a}})});