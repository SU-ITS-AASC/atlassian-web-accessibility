AJS.toInit(function(b){function g(a,c,d,e,g){var f="true"===a.attr("data-enabled");AJS.trigger("analytics",{name:"blueprint.template."+(f?"disable":"enable"),data:{}});b.ajax({url:d,type:f?"DELETE":"PUT",contentType:"application/vnd.atl.plugins.plugin.module+json",success:function(b){a.attr("data-enabled",!f);a.text(f?AJS.I18n.getText("enable.name"):AJS.I18n.getText("disable.name"));g.toggleClass("disabled",f);c&&(b=a.siblings(".promoted-state-toggle-trigger"),f?h.disableElement(b):h.enableElement(b))},
error:function(){AJS.log("Could not enable/disable blueprint with id: "+e)}});return!1}var h=require("confluence/form-state-control");b("#content-blueprint-templates .module-state-toggle-trigger").click(function(){var a=AJS.Meta.get("space-key")||b("meta[name\x3dconfluence-space-key]").attr("content"),c=b(this),d=c.closest(".web-item-module"),e=d.data("content-blueprint-id");a=Confluence.getContextPath()+"/rest/create-dialog/1.0/modules/"+e+(a?"?spaceKey\x3d"+a:"");return g(c,!0,a,e,d)});b("#space-blueprints-admin-table .module-state-toggle-trigger").click(function(){var a=
b(this),c=a.closest(".web-item-module"),d=c.data("space-blueprint-id"),e=Confluence.getContextPath()+"/rest/create-dialog/1.0/modules/space-blueprint/"+d;return g(a,!0,e,d,c)});b(".web-item-module .template-operations a").click(function(a){b(this).closest(".web-item-module").is(".disabled")&&(a.preventDefault(),a.stopPropagation())});var k=b(".promoted-state-toggle-trigger");k.tooltip({aria:!0});k.click(function(a){var c=b(this),d="true"===c.attr("data-promoted");l(c,d);a.preventDefault()});var l=
function(a,c){var d=a.closest(".web-item-module").data("content-blueprint-id"),e=AJS.Meta.get("space-key");e||(e=b("meta[name\x3dconfluence-space-key]").attr("content"));h.disableElement(a);AJS.trigger("analytics",{name:"blueprint.template."+(c?"unpromote":"promote"),data:{}});b.ajax({url:Confluence.getContextPath()+"/rest/create-dialog/1.0/promotion/promote-blueprint/"+d+(e?"?spaceKey\x3d"+e:""),type:c?"DELETE":"PUT",contentType:"application/json"}).done(function(){a.attr("data-promoted",!c);a.text(c?
AJS.I18n.getText("create.content.plugin.templates.promoted.name"):AJS.I18n.getText("create.content.plugin.templates.non.promoted.name"))}).fail(function(){AJS.log("Could not promote/demote blueprint with id: "+d)}).always(function(){h.enableElement(a)})}});