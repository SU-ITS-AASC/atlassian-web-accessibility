AJS.toInit(function(c){Confluence.SpaceBlueprint.Dialog=c.extend(Confluence.Dialogs.CreateDialogBase({dialogId:"create-dialog",webItemsPath:"/rest/create-dialog/1.0/space-blueprint/dialog/web-items",helpLinkTemplate:Confluence.Templates.Blueprints.spaceHelpLink,headingText:AJS.I18n.getText("create.content.plugin.create-dialog.header.create.space.label")}),{getParentPageId:function(){},getSpaceKey:function(){},launch:function(b){var d=Confluence.SpaceBlueprint.Dialog.openDialog(b?{showDialog:!1,updateHeight:!1,
showStepOne:!0,initContext:{}}:{});createSpacePromise=WRM.require("wrc!create-space");webItemsPromise=Confluence.SpaceBlueprint.Dialog.requestWebItems();AJS.$.when(createSpacePromise,webItemsPromise).done(function(a,c){AJS.trigger("blueprint.wizard-register.load");!b&&Confluence.SpaceBlueprint.WelcomeDialog.isShowWelcomeDialog()?(Confluence.SpaceBlueprint.WelcomeDialog.showWelcomeDialog(),d.remove()):(Confluence.SpaceBlueprint.Dialog.fillWebItemsInDialog(),a=Confluence.SpaceBlueprint.Dialog.loadedWebitems[void 0],
_.isEmpty(a)?AJS.log("Could not load space dialog - web items not found"):b&&((a=_.find(a,function(a){return a.itemModuleCompleteKey===b}))?(Confluence.Blueprint.fireWizard(c[0],a,d),d.removeBackButton(),(a.howToUseTemplate&&!a.skipHowToUse||Confluence.Blueprint.hasWizard(b,a))&&d.show()):AJS.log("Error finding space blueprint with id"+b)))}).fail(function(a){AJS.log("Could not load resources for space dialog");var b=AJS.I18n.getText("server.error.message");try{"READ_ONLY"===JSON.parse(a.responseText).errorType&&
(b=AJS.I18n.getText("read.only.mode.default.error.short.message"))}catch(g){}finally{d.setDialogError(b)}})}});var f=c('#create-space-button, a[href\x3d"'+Confluence.getContextPath()+'/spaces/createspace-start.action"]'),e=c("#create-personal-space-link");e.length&&(e.unbind("click"),e.click(function(){Confluence.SpaceBlueprint.Dialog.launch("com.atlassian.confluence.plugins.confluence-create-content-plugin:create-personal-space-item");return!1}));f.length&&(c('a[href\x3d"'+Confluence.getContextPath()+
'/spaces/createspace-start.action"]').unbind("click"),f.click(function(b){Confluence.SpaceBlueprint.Dialog.launch();return!1}),Confluence.SpaceBlueprint.loaded.resolve())});