define("atlassian-tinymce/plugins/template/editor_plugin_src",["tinymce"],function(f){var g=f.each;return{init:function(b,a){var c=this;c.editor=b;b.addCommand("mceTemplate",function(){b.windowManager.open({file:a+"/template.htm",width:b.getParam("template_popup_width",750),height:b.getParam("template_popup_height",600),inline:1},{plugin_url:a})});b.addCommand("mceInsertTemplate",c._insertTemplate,c);b.addButton("template",{title:"template.desc",cmd:"mceTemplate"});b.onPreProcess.add(function(a,b){var d=
a.dom;g(d.select("div",b.node),function(b){d.hasClass(b,"mceTmpl")&&(g(d.select("*",b),function(b){d.hasClass(b,a.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|"))&&(b.innerHTML=c._getDateTime(new Date,a.getParam("template_mdate_format",a.getLang("template.mdate_format"))))}),c._replaceVals(b))})})},getInfo:function(){return{longname:"Template plugin",author:"Moxiecode Systems AB",authorurl:"http://www.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/template",
version:f.majorVersion+"."+f.minorVersion}},_insertTemplate:function(b,a){function c(a,b){return RegExp("\\b"+b+"\\b","g").test(a.className)}var i=this,e=i.editor,d,h,f=e.dom,k=e.selection.getContent();d=a.content;g(i.editor.getParam("template_replace_values"),function(a,b){"function"!==typeof a&&(d=d.replace(RegExp("\\{\\$"+b+"\\}","g"),a))});h=f.create("div",null,d);var j=f.select(".mceTmpl",h);j&&0<j.length&&(h=f.create("div",null),h.appendChild(j[0].cloneNode(!0)));g(f.select("*",h),function(a){if(c(a,
e.getParam("template_cdate_classes","cdate").replace(/\s+/g,"|")))a.innerHTML=i._getDateTime(new Date,e.getParam("template_cdate_format",e.getLang("template.cdate_format")));if(c(a,e.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|")))a.innerHTML=i._getDateTime(new Date,e.getParam("template_mdate_format",e.getLang("template.mdate_format")));if(c(a,e.getParam("template_selected_content_classes","selcontent").replace(/\s+/g,"|")))a.innerHTML=k});i._replaceVals(h);e.execCommand("mceInsertContent",
!1,h.innerHTML);e.addVisual()},_replaceVals:function(b){var a=this.editor.dom,c=this.editor.getParam("template_replace_values");g(a.select("*",b),function(b){g(c,function(e,d){if(a.hasClass(b,d)&&"function"===typeof c[d])c[d](b)})})},_getDateTime:function(b,a){function c(a,b){var c,a=""+a;if(a.length<b)for(c=0;c<b-a.length;c++)a="0"+a;return a}if(!a)return"";a=a.replace("%D","%m/%d/%y");a=a.replace("%r","%I:%M:%S %p");a=a.replace("%Y",""+b.getFullYear());a=a.replace("%y",""+b.getYear());a=a.replace("%m",
c(b.getMonth()+1,2));a=a.replace("%d",c(b.getDate(),2));a=a.replace("%H",""+c(b.getHours(),2));a=a.replace("%M",""+c(b.getMinutes(),2));a=a.replace("%S",""+c(b.getSeconds(),2));a=a.replace("%I",""+((b.getHours()+11)%12+1));a=a.replace("%p",""+(12>b.getHours()?"AM":"PM"));a=a.replace("%B",""+this.editor.getLang("template_months_long").split(",")[b.getMonth()]);a=a.replace("%b",""+this.editor.getLang("template_months_short").split(",")[b.getMonth()]);a=a.replace("%A",""+this.editor.getLang("template_day_long").split(",")[b.getDay()]);
a=a.replace("%a",""+this.editor.getLang("template_day_short").split(",")[b.getDay()]);return a=a.replace("%%","%")}}});require("confluence/module-exporter").safeRequire("atlassian-tinymce/plugins/template/editor_plugin_src",function(f){var g=require("tinymce");g.create("tinymce.plugins.TemplatePlugin",f);g.PluginManager.add("template",g.plugins.TemplatePlugin)});